Issuer: https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key
Profile: code
Test ID: rp-key-rotation-rp-enc-key
Test description: Can Request and Use Encrypted UserInfo Response
Timestamp: 2016-09-16T07:15:48Z

============================================================

Trace output

Trace init: Fri, 16 Sep 2016 07:15:47 +0000
0.000102 Conversation initiated
0.000206 <--<-- 0 --- <class 'oidctest.op.oper.Webfinger'> -->-->
0.000257 op_args: {}
0.000261 Running 'Webfinger'
0.000264 Discovery of resource: https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key
0.000270 Running discover with kwargs: {'principal': 'https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key'}
0.112359 <-- https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key
0.112447 <--<-- 1 --- <class 'oidctest.op.oper.Discovery'> -->-->
0.112494 op_args: {'issuer': 'https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key'}
0.112498 Running 'Discovery'
0.112503 Running provider_config with kwargs: {'issuer': 'https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key'}
0.118957 ProviderConfigurationResponse: {
  "acr_values_supported": [
    "PASSWORD"
  ],
  "authorization_endpoint": "https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key/authorization",
  "claim_types_supported": [
    "normal",
    "aggregated",
    "distributed"
  ],
  "claims_parameter_supported": true,
  "claims_supported": [
    "zoneinfo",
    "preferred_username",
    "picture",
    "updated_at",
    "middle_name",
    "phone_number",
    "address",
    "name",
    "nickname",
    "email_verified",
    "locale",
    "gender",
    "family_name",
    "phone_number_verified",
    "profile",
    "website",
    "sub",
    "given_name",
    "birthdate",
    "email"
  ],
  "end_session_endpoint": "https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key/end_session",
  "grant_types_supported": [
    "authorization_code",
    "implicit",
    "urn:ietf:params:oauth:grant-type:jwt-bearer"
  ],
  "id_token_encryption_alg_values_supported": [
    "RSA1_5",
    "RSA-OAEP",
    "A128KW",
    "A192KW",
    "A256KW",
    "ECDH-ES",
    "ECDH-ES+A128KW",
    "ECDH-ES+A192KW",
    "ECDH-ES+A256KW"
  ],
  "id_token_encryption_enc_values_supported": [
    "A128CBC-HS256",
    "A192CBC-HS384",
    "A256CBC-HS512",
    "A128GCM",
    "A192GCM",
    "A256GCM"
  ],
  "id_token_signing_alg_values_supported": [
    "RS256",
    "RS384",
    "RS512",
    "ES256",
    "ES384",
    "ES512",
    "HS256",
    "HS384",
    "HS512",
    "PS256",
    "PS384",
    "PS512",
    "none"
  ],
  "issuer": "https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key",
  "jwks_uri": "https://localhost:8080/static/jwks_EPQyNOxJBVeRQVvA.json",
  "registration_endpoint": "https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key/registration",
  "request_object_encryption_alg_values_supported": [
    "RSA1_5",
    "RSA-OAEP",
    "A128KW",
    "A192KW",
    "A256KW",
    "ECDH-ES",
    "ECDH-ES+A128KW",
    "ECDH-ES+A192KW",
    "ECDH-ES+A256KW"
  ],
  "request_object_encryption_enc_values_supported": [
    "A128CBC-HS256",
    "A192CBC-HS384",
    "A256CBC-HS512",
    "A128GCM",
    "A192GCM",
    "A256GCM"
  ],
  "request_object_signing_alg_values_supported": [
    "RS256",
    "RS384",
    "RS512",
    "ES256",
    "ES384",
    "ES512",
    "HS256",
    "HS384",
    "HS512",
    "PS256",
    "PS384",
    "PS512",
    "none"
  ],
  "request_parameter_supported": true,
  "request_uri_parameter_supported": true,
  "require_request_uri_registration": true,
  "response_modes_supported": [
    "query",
    "fragment",
    "form_post"
  ],
  "response_types_supported": [
    "code",
    "token",
    "id_token",
    "code token",
    "code id_token",
    "id_token token",
    "code token id_token",
    "none"
  ],
  "scopes_supported": [
    "email",
    "profile",
    "openid",
    "offline_access",
    "address",
    "phone",
    "openid"
  ],
  "subject_types_supported": [
    "public",
    "pairwise"
  ],
  "token_endpoint": "https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key/token",
  "token_endpoint_auth_methods_supported": [
    "client_secret_post",
    "client_secret_basic",
    "client_secret_jwt",
    "private_key_jwt"
  ],
  "token_endpoint_auth_signing_alg_values_supported": [
    "RS256",
    "RS384",
    "RS512",
    "ES256",
    "ES384",
    "ES512",
    "HS256",
    "HS384",
    "HS512",
    "PS256",
    "PS384",
    "PS512"
  ],
  "userinfo_encryption_alg_values_supported": [
    "RSA1_5",
    "RSA-OAEP",
    "A128KW",
    "A192KW",
    "A256KW",
    "ECDH-ES",
    "ECDH-ES+A128KW",
    "ECDH-ES+A192KW",
    "ECDH-ES+A256KW"
  ],
  "userinfo_encryption_enc_values_supported": [
    "A128CBC-HS256",
    "A192CBC-HS384",
    "A256CBC-HS512",
    "A128GCM",
    "A192GCM",
    "A256GCM"
  ],
  "userinfo_endpoint": "https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key/userinfo",
  "userinfo_signing_alg_values_supported": [
    "RS256",
    "RS384",
    "RS512",
    "ES256",
    "ES384",
    "ES512",
    "HS256",
    "HS384",
    "HS512",
    "PS256",
    "PS384",
    "PS512",
    "none"
  ],
  "version": "3.0"
}
0.119348 <-- {'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'token_endpoint': 'https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key/token', 'version': '3.0', 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'end_session_endpoint': 'https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key/end_session', 'request_object_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'HS256', 'HS384', 'HS512', 'PS256', 'PS384', 'PS512', 'none'], 'token_endpoint_auth_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'HS256', 'HS384', 'HS512', 'PS256', 'PS384', 'PS512'], 'issuer': 'https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key', 'claims_supported': ['zoneinfo', 'preferred_username', 'picture', 'updated_at', 'middle_name', 'phone_number', 'address', 'name', 'nickname', 'email_verified', 'locale', 'gender', 'family_name', 'phone_number_verified', 'profile', 'website', 'sub', 'given_name', 'birthdate', 'email'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'registration_endpoint': 'https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key/registration', 'claims_parameter_supported': True, 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'id_token_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'HS256', 'HS384', 'HS512', 'PS256', 'PS384', 'PS512', 'none'], 'subject_types_supported': ['public', 'pairwise'], 'require_request_uri_registration': True, 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_uri_parameter_supported': True, 'scopes_supported': ['email', 'profile', 'openid', 'offline_access', 'address', 'phone', 'openid'], 'authorization_endpoint': 'https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key/authorization', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'acr_values_supported': ['PASSWORD'], 'jwks_uri': 'https://localhost:8080/static/jwks_EPQyNOxJBVeRQVvA.json', 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token', 'none'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_parameter_supported': True, 'userinfo_endpoint': 'https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key/userinfo', 'userinfo_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'HS256', 'HS384', 'HS512', 'PS256', 'PS384', 'PS512', 'none']}
0.119475 <--<-- 2 --- <class 'oidctest.op.oper.Registration'> -->-->
0.119525 op_args: {}
0.119529 Running 'Registration'
0.119540 Running register with kwargs: {'userinfo_encrypted_response_enc': 'A128CBC-HS256', 'response_types': ['code'], 'contact': ['foo@example.com'], 'redirect_uris': ['https://localhost:8088/authz_cb'], 'grant_types': ['authorization_code'], 'url': 'https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key/registration', 'jwks_uri': 'https://localhost:8088/static/jwk.json', 'application_type': 'web', 'userinfo_encrypted_response_alg': 'RSA1_5'}
0.133738 RegistrationResponse: {
  "application_type": "web",
  "client_id": "TiREq4y87xFg",
  "client_id_issued_at": 1474010147,
  "client_secret": "a6115f7ba2e8e95e1069eb21fa4149d18b5da1cb739385a92a4fa69e",
  "client_secret_expires_at": 1474096547,
  "grant_types": [
    "authorization_code"
  ],
  "jwks_uri": "https://localhost:8088/static/jwk.json",
  "redirect_uris": [
    "https://localhost:8088/authz_cb"
  ],
  "registration_access_token": "FFPEc9mWVxtjU0XyGDqwhF7ivDAnQa9o",
  "registration_client_uri": "https://localhost:8080/foobar1_C/registration?client_id=TiREq4y87xFg",
  "response_types": [
    "code"
  ],
  "userinfo_encrypted_response_alg": "RSA1_5",
  "userinfo_encrypted_response_enc": "A128CBC-HS256"
}
0.133848 <-- {'client_id_issued_at': 1474010147, 'token_endpoint_auth_method': 'client_secret_basic', 'client_secret': 'a6115f7ba2e8e95e1069eb21fa4149d18b5da1cb739385a92a4fa69e', 'client_secret_expires_at': 1474096547, 'client_id': 'TiREq4y87xFg', 'userinfo_encrypted_response_alg': 'RSA1_5', 'userinfo_encrypted_response_enc': 'A128CBC-HS256', 'response_types': ['code'], 'registration_client_uri': 'https://localhost:8080/foobar1_C/registration?client_id=TiREq4y87xFg', 'redirect_uris': ['https://localhost:8088/authz_cb'], 'grant_types': ['authorization_code'], 'jwks_uri': 'https://localhost:8088/static/jwk.json', 'registration_access_token': 'FFPEc9mWVxtjU0XyGDqwhF7ivDAnQa9o', 'application_type': 'web'}
0.133956 <--<-- 3 --- <class 'oidctest.op.oper.SyncAuthn'> -->-->
0.134233 op_args: {'endpoint': 'https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key/authorization'}
0.134237 Running 'SyncAuthn'
0.134351 ==================== SyncAuthn ====================
0.134354 --> URL: https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key/authorization?client_id=TiREq4y87xFg&nonce=oc9PftwI14maMRpA&response_type=code&scope=openid&state=2pAJGqcvlVaeBO1X&redirect_uri=https%3A%2F%2Flocalhost%3A8088%2Fauthz_cb
0.141270 <-- RESPONSE: <Response [303]>
0.141281 <-- CONTENT: <html>
<head><title>Redirecting to https://localhost:8088/authz_cb?state=2pAJGqcvlVaeBO1X&iss=https%3A%2F%2Flocalhost%3A8080%2Ffoobar1_C%2Frp-key-rotation-rp-enc-key&code=sOwI63uqld3G%2FRnPnaD0n2iUA9UIDCRA%2FQeb0QqN5dKt7qxFRLfWbvHjhYtNpqqkZJwKIcI6BYho3kCTbAAzo%2FeXMIkHo3Ri5BW2FeEZdPKcvZxr9jZSRo%2BdBIYZo5axCy006ijg9biiZ0dRPBMtUQ%3D%3D&scope=openid&client_id=TiREq4y87xFg</title></head>
<body>
You are being redirected to <a href="https://localhost:8088/authz_cb?state=2pAJGqcvlVaeBO1X&iss=https%3A%2F%2Flocalhost%3A8080%2Ffoobar1_C%2Frp-key-rotation-rp-enc-key&code=sOwI63uqld3G%2FRnPnaD0n2iUA9UIDCRA%2FQeb0QqN5dKt7qxFRLfWbvHjhYtNpqqkZJwKIcI6BYho3kCTbAAzo%2FeXMIkHo3Ri5BW2FeEZdPKcvZxr9jZSRo%2BdBIYZo5axCy006ijg9biiZ0dRPBMtUQ%3D%3D&scope=openid&client_id=TiREq4y87xFg">https://localhost:8088/authz_cb?state=2pAJGqcvlVaeBO1X&iss=https%3A%2F%2Flocalhost%3A8080%2Ffoobar1_C%2Frp-key-rotation-rp-enc-key&code=sOwI63uqld3G%2FRnPnaD0n2iUA9UIDCRA%2FQeb0QqN5dKt7qxFRLfWbvHjhYtNpqqkZJwKIcI6BYho3kCTbAAzo%2FeXMIkHo3Ri5BW2FeEZdPKcvZxr9jZSRo%2BdBIYZo5axCy006ijg9biiZ0dRPBMtUQ%3D%3D&scope=openid&client_id=TiREq4y87xFg</a>
</body>
</html>
0.141283 <-- REASON: See Other
0.141299 <-- COOKIES: {'pyoic': '"ygnGAHTSbB01xwP3jdZEoRdCe2bDdlT0T2FwRnnrCWueEiSKqOvN/aGEIvW83Z6pDwgYEtbrJeCjdH8mmjMZxg==|1474010147|61a34f7bc04014f9ff302e15b43f51abc04738bf"'}
0.141311 Running handle_response with kwargs: {'csi': <oic.oic.message.AuthorizationRequest object at 0x107195c88>, 'r': <Response [303]>}
0.141596 AuthorizationResponse: {
  "client_id": "TiREq4y87xFg",
  "code": "sOwI63uqld3G/RnPnaD0n2iUA9UIDCRA/Qeb0QqN5dKt7qxFRLfWbvHjhYtNpqqkZJwKIcI6BYho3kCTbAAzo/eXMIkHo3Ri5BW2FeEZdPKcvZxr9jZSRo+dBIYZo5axCy006ijg9biiZ0dRPBMtUQ==",
  "iss": "https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key",
  "scope": "openid",
  "state": "2pAJGqcvlVaeBO1X"
}
0.141666 <-- {'client_id': 'TiREq4y87xFg', 'iss': 'https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key', 'code': 'sOwI63uqld3G/RnPnaD0n2iUA9UIDCRA/Qeb0QqN5dKt7qxFRLfWbvHjhYtNpqqkZJwKIcI6BYho3kCTbAAzo/eXMIkHo3Ri5BW2FeEZdPKcvZxr9jZSRo+dBIYZo5axCy006ijg9biiZ0dRPBMtUQ==', 'scope': 'openid', 'state': '2pAJGqcvlVaeBO1X'}
0.141681 AuthorizationResponse: {
  "client_id": "TiREq4y87xFg",
  "code": "sOwI63uqld3G/RnPnaD0n2iUA9UIDCRA/Qeb0QqN5dKt7qxFRLfWbvHjhYtNpqqkZJwKIcI6BYho3kCTbAAzo/eXMIkHo3Ri5BW2FeEZdPKcvZxr9jZSRo+dBIYZo5axCy006ijg9biiZ0dRPBMtUQ==",
  "iss": "https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key",
  "scope": "openid",
  "state": "2pAJGqcvlVaeBO1X"
}
0.141782 <--<-- 4 --- <class 'oidctest.op.oper.AccessToken'> -->-->
0.141831 op_args: {'state': '2pAJGqcvlVaeBO1X'}
0.141835 Running 'AccessToken'
0.141839 Running _run with kwargs: {}
0.141844 Access Token Request with op_args: {'state': '2pAJGqcvlVaeBO1X'}, req_args: {'redirect_uri': 'https://localhost:8088/authz_cb'}
0.161940 AccessTokenResponse: {
  "access_token": "ga68N0sIwQpA/HSMEb+vBEhwisoL+y5H3YCF1AQcQLfmHEO1zUZAve8Wh1xS3P/0TSCvsi49GDh3+fbS9DBVlg6sRLYv2dWiXmwVxivYrh/fgJ4zrClH42OO6KaVWwBUeTmZRVDima6ngrpeitsz3A==",
  "id_token": {
    "claims": {
      "acr": "PASSWORD",
      "aud": [
        "TiREq4y87xFg"
      ],
      "auth_time": 1474010147,
      "exp": 1474096547,
      "iat": 1474010147,
      "iss": "https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key",
      "nonce": "oc9PftwI14maMRpA",
      "sub": "1b2fc9341a16ae4e30082965d537ae47c21a0f27fd43eab78330ed81751ae6db"
    },
    "jws header parameters": {
      "alg": "RS256",
      "kid": "a1"
    }
  },
  "scope": "openid",
  "state": "2pAJGqcvlVaeBO1X",
  "token_type": "Bearer"
}
0.162066 AccessTokenResponse: {
  "access_token": "ga68N0sIwQpA/HSMEb+vBEhwisoL+y5H3YCF1AQcQLfmHEO1zUZAve8Wh1xS3P/0TSCvsi49GDh3+fbS9DBVlg6sRLYv2dWiXmwVxivYrh/fgJ4zrClH42OO6KaVWwBUeTmZRVDima6ngrpeitsz3A==",
  "id_token": {
    "claims": {
      "acr": "PASSWORD",
      "aud": [
        "TiREq4y87xFg"
      ],
      "auth_time": 1474010147,
      "exp": 1474096547,
      "iat": 1474010147,
      "iss": "https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key",
      "nonce": "oc9PftwI14maMRpA",
      "sub": "1b2fc9341a16ae4e30082965d537ae47c21a0f27fd43eab78330ed81751ae6db"
    },
    "jws header parameters": {
      "alg": "RS256",
      "kid": "a1"
    }
  },
  "scope": "openid",
  "state": "2pAJGqcvlVaeBO1X",
  "token_type": "Bearer"
}
0.162200 <--<-- 5 --- <class 'oidctest.op.oper.UserInfo'> -->-->
0.162247 op_args: {'state': '2pAJGqcvlVaeBO1X'}
0.162251 Running 'UserInfo'
0.188554 UserInfo: {
  "claims": {
    "sub": "1b2fc9341a16ae4e30082965d537ae47c21a0f27fd43eab78330ed81751ae6db"
  },
  "jwe header parameters": {
    "alg": "RSA1_5",
    "enc": "A128CBC-HS256",
    "kid": "mdQvIWL9ZY8J1v2pFCvn6FfDG7bHGxtfFxpzKxCvbUw"
  }
}
0.188633 UserInfo: {
  "claims": {
    "sub": "1b2fc9341a16ae4e30082965d537ae47c21a0f27fd43eab78330ed81751ae6db"
  },
  "jwe header parameters": {
    "alg": "RSA1_5",
    "enc": "A128CBC-HS256",
    "kid": "mdQvIWL9ZY8J1v2pFCvn6FfDG7bHGxtfFxpzKxCvbUw"
  }
}
0.188734 <--<-- 6 --- <class 'oidctest.op.oper.RotateKey'> -->-->
0.188793 op_args: {'old_key': {'alg': 'RSA1_5', 'use': 'enc'}, 'jwks_path': 'static/jwk.json', 'new_key': {'bits': 2048, 'use': ['enc'], 'type': 'RSA'}, 'new_kid': 'rotated_enc_key'}
1.620156 <--<-- 7 --- <class 'oidctest.op.oper.SyncAuthn'> -->-->
1.620444 op_args: {'endpoint': 'https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key/authorization'}
1.620449 Running 'SyncAuthn'
1.620582 ==================== SyncAuthn ====================
1.620585 --> URL: https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key/authorization?client_id=TiREq4y87xFg&nonce=ifEZ6tv2jHCXvv91&response_type=code&scope=openid&state=vteEfhgLQEuHNjdh&redirect_uri=https%3A%2F%2Flocalhost%3A8088%2Fauthz_cb
1.627885 <-- RESPONSE: <Response [303]>
1.627893 <-- CONTENT: <html>
<head><title>Redirecting to https://localhost:8088/authz_cb?state=vteEfhgLQEuHNjdh&iss=https%3A%2F%2Flocalhost%3A8080%2Ffoobar1_C%2Frp-key-rotation-rp-enc-key&code=7njxEOMwLrgMKirwm7CoBW6DrniUnOmX97u%2B0%2Bx%2B%2FusRsuR8182m8F%2BZcggBKqcVnxZlK1DHmiyRcMmPrkzj3NJQxJ993y1L7fR6FkdIx%2FvBKQwLS0IYF8eu0ShXXZMd32TY%2BVT0MyVqXg8Kc6yD%2Bw%3D%3D&scope=openid&client_id=TiREq4y87xFg</title></head>
<body>
You are being redirected to <a href="https://localhost:8088/authz_cb?state=vteEfhgLQEuHNjdh&iss=https%3A%2F%2Flocalhost%3A8080%2Ffoobar1_C%2Frp-key-rotation-rp-enc-key&code=7njxEOMwLrgMKirwm7CoBW6DrniUnOmX97u%2B0%2Bx%2B%2FusRsuR8182m8F%2BZcggBKqcVnxZlK1DHmiyRcMmPrkzj3NJQxJ993y1L7fR6FkdIx%2FvBKQwLS0IYF8eu0ShXXZMd32TY%2BVT0MyVqXg8Kc6yD%2Bw%3D%3D&scope=openid&client_id=TiREq4y87xFg">https://localhost:8088/authz_cb?state=vteEfhgLQEuHNjdh&iss=https%3A%2F%2Flocalhost%3A8080%2Ffoobar1_C%2Frp-key-rotation-rp-enc-key&code=7njxEOMwLrgMKirwm7CoBW6DrniUnOmX97u%2B0%2Bx%2B%2FusRsuR8182m8F%2BZcggBKqcVnxZlK1DHmiyRcMmPrkzj3NJQxJ993y1L7fR6FkdIx%2FvBKQwLS0IYF8eu0ShXXZMd32TY%2BVT0MyVqXg8Kc6yD%2Bw%3D%3D&scope=openid&client_id=TiREq4y87xFg</a>
</body>
</html>
1.627894 <-- REASON: See Other
1.627908 <-- COOKIES: {'pyoic': 'ygnGAHTSbB01xwP3jdZEoRdCe2bDdlT0T2FwRnnrCWueEiSKqOvN/aGEIvW83Z6pDwgYEtbrJeCjdH8mmjMZxg==|1474010147|61a34f7bc04014f9ff302e15b43f51abc04738bf'}
1.627919 Running handle_response with kwargs: {'csi': <oic.oic.message.AuthorizationRequest object at 0x107198518>, 'r': <Response [303]>}
1.628157 AuthorizationResponse: {
  "client_id": "TiREq4y87xFg",
  "code": "7njxEOMwLrgMKirwm7CoBW6DrniUnOmX97u+0+x+/usRsuR8182m8F+ZcggBKqcVnxZlK1DHmiyRcMmPrkzj3NJQxJ993y1L7fR6FkdIx/vBKQwLS0IYF8eu0ShXXZMd32TY+VT0MyVqXg8Kc6yD+w==",
  "iss": "https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key",
  "scope": "openid",
  "state": "vteEfhgLQEuHNjdh"
}
1.628224 <-- {'client_id': 'TiREq4y87xFg', 'iss': 'https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key', 'code': '7njxEOMwLrgMKirwm7CoBW6DrniUnOmX97u+0+x+/usRsuR8182m8F+ZcggBKqcVnxZlK1DHmiyRcMmPrkzj3NJQxJ993y1L7fR6FkdIx/vBKQwLS0IYF8eu0ShXXZMd32TY+VT0MyVqXg8Kc6yD+w==', 'scope': 'openid', 'state': 'vteEfhgLQEuHNjdh'}
1.628238 AuthorizationResponse: {
  "client_id": "TiREq4y87xFg",
  "code": "7njxEOMwLrgMKirwm7CoBW6DrniUnOmX97u+0+x+/usRsuR8182m8F+ZcggBKqcVnxZlK1DHmiyRcMmPrkzj3NJQxJ993y1L7fR6FkdIx/vBKQwLS0IYF8eu0ShXXZMd32TY+VT0MyVqXg8Kc6yD+w==",
  "iss": "https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key",
  "scope": "openid",
  "state": "vteEfhgLQEuHNjdh"
}
1.628338 <--<-- 8 --- <class 'oidctest.op.oper.AccessToken'> -->-->
1.628386 op_args: {'state': 'vteEfhgLQEuHNjdh'}
1.628389 Running 'AccessToken'
1.628393 Running _run with kwargs: {}
1.628397 Access Token Request with op_args: {'state': 'vteEfhgLQEuHNjdh'}, req_args: {'redirect_uri': 'https://localhost:8088/authz_cb'}
1.791611 AccessTokenResponse: {
  "access_token": "Dh8kNC3RQD+0owwzUaXPOwmBGzCGX5oopumtBsANdqdmywj23rc2diUgCENekBod2SsZLTTW6zIt76xj8BG+MT40/Wg3Ln8W2D7yvcXribEzWOAV6VoYzxV+QhPaaC2bjQn7fr601nthHt3Te7iESQ==",
  "id_token": {
    "claims": {
      "acr": "PASSWORD",
      "aud": [
        "TiREq4y87xFg"
      ],
      "auth_time": 1474010148,
      "exp": 1474096548,
      "iat": 1474010148,
      "iss": "https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key",
      "nonce": "ifEZ6tv2jHCXvv91",
      "sub": "1b2fc9341a16ae4e30082965d537ae47c21a0f27fd43eab78330ed81751ae6db"
    },
    "jws header parameters": {
      "alg": "RS256",
      "kid": "a1"
    }
  },
  "scope": "openid",
  "state": "vteEfhgLQEuHNjdh",
  "token_type": "Bearer"
}
1.791734 AccessTokenResponse: {
  "access_token": "Dh8kNC3RQD+0owwzUaXPOwmBGzCGX5oopumtBsANdqdmywj23rc2diUgCENekBod2SsZLTTW6zIt76xj8BG+MT40/Wg3Ln8W2D7yvcXribEzWOAV6VoYzxV+QhPaaC2bjQn7fr601nthHt3Te7iESQ==",
  "id_token": {
    "claims": {
      "acr": "PASSWORD",
      "aud": [
        "TiREq4y87xFg"
      ],
      "auth_time": 1474010148,
      "exp": 1474096548,
      "iat": 1474010148,
      "iss": "https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key",
      "nonce": "ifEZ6tv2jHCXvv91",
      "sub": "1b2fc9341a16ae4e30082965d537ae47c21a0f27fd43eab78330ed81751ae6db"
    },
    "jws header parameters": {
      "alg": "RS256",
      "kid": "a1"
    }
  },
  "scope": "openid",
  "state": "vteEfhgLQEuHNjdh",
  "token_type": "Bearer"
}
1.791865 <--<-- 9 --- <class 'oidctest.op.oper.UserInfo'> -->-->
1.791912 op_args: {'state': 'vteEfhgLQEuHNjdh'}
1.791916 Running 'UserInfo'
1.813004 UserInfo: {
  "claims": {
    "sub": "1b2fc9341a16ae4e30082965d537ae47c21a0f27fd43eab78330ed81751ae6db"
  },
  "jwe header parameters": {
    "alg": "RSA1_5",
    "enc": "A128CBC-HS256",
    "kid": "rotated_enc_key"
  }
}
1.813079 UserInfo: {
  "claims": {
    "sub": "1b2fc9341a16ae4e30082965d537ae47c21a0f27fd43eab78330ed81751ae6db"
  },
  "jwe header parameters": {
    "alg": "RSA1_5",
    "enc": "A128CBC-HS256",
    "kid": "rotated_enc_key"
  }
}
1.813177 <--<-- 10 --- <class 'oidctest.op.oper.RestoreKeyJar'> -->-->
1.813229 op_args: {'jwks_path': 'static/jwk.json'}
1.814897 <--<-- 11 --- <class 'otest.Done'> -->-->
1.814922 op_args: {}
1.814925 Running 'Done'
1.814927 ==== END ====



============================================================

Conditions

Done: status=OK



============================================================

Events
1474010147.276502:response:https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key
1474010147.276513:issuer:https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key
1474010147.283088:response:{"grant_types_supported": ["authorization_code", "implicit", "urn:ietf:params:oauth:grant-type:jwt-bearer"], "userinfo_encryption_alg_values_supported": ["RSA1_5", "RSA-OAEP", "A128KW", "A192KW", "A256KW", "ECDH-ES", "ECDH-ES+A128KW", "ECDH-ES+A192KW", "ECDH-ES+A256KW"], "claims_parameter_supported": true, "require_request_uri_registration": true, "request_object_encryption_enc_values_supported": ["A128CBC-HS256", "A192CBC-HS384", "A256CBC-HS512", "A128GCM", "A192GCM", "A256GCM"], "id_token_encryption_enc_values_supported": ["A128CBC-HS256", "A192CBC-HS384", "A256CBC-HS512", "A128GCM", "A192GCM", "A256GCM"], "authorization_endpoint": "https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key/authorization", "token_endpoint": "https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key/token", "subject_types_supported": ["public", "pairwise"], "acr_values_supported": ["PASSWORD"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "HS256", "HS384", "HS512", "PS256", "PS384", "PS512", "none"], "jwks_uri": "https://localhost:8080/static/jwks_EPQyNOxJBVeRQVvA.json", "token_endpoint_auth_methods_supported": ["client_secret_post", "client_secret_basic", "client_secret_jwt", "private_key_jwt"], "request_object_encryption_alg_values_supported": ["RSA1_5", "RSA-OAEP", "A128KW", "A192KW", "A256KW", "ECDH-ES", "ECDH-ES+A128KW", "ECDH-ES+A192KW", "ECDH-ES+A256KW"], "id_token_encryption_alg_values_supported": ["RSA1_5", "RSA-OAEP", "A128KW", "A192KW", "A256KW", "ECDH-ES", "ECDH-ES+A128KW", "ECDH-ES+A192KW", "ECDH-ES+A256KW"], "request_parameter_supported": true, "claim_types_supported": ["normal", "aggregated", "distributed"], "token_endpoint_auth_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "HS256", "HS384", "HS512", "PS256", "PS384", "PS512"], "claims_supported": ["zoneinfo", "preferred_username", "picture", "updated_at", "middle_name", "phone_number", "address", "name", "nickname", "email_verified", "locale", "gender", "family_name", "phone_number_verified", "profile", "website", "sub", "given_name", "birthdate", "email"], "request_uri_parameter_supported": true, "end_session_endpoint": "https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key/end_session", "issuer": "https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key", "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "HS256", "HS384", "HS512", "PS256", "PS384", "PS512", "none"], "scopes_supported": ["email", "profile", "openid", "offline_access", "address", "phone", "openid"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "HS256", "HS384", "HS512", "PS256", "PS384", "PS512", "none"], "response_types_supported": ["code", "token", "id_token", "code token", "code id_token", "id_token token", "code token id_token", "none"], "response_modes_supported": ["query", "fragment", "form_post"], "userinfo_encryption_enc_values_supported": ["A128CBC-HS256", "A192CBC-HS384", "A256CBC-HS512", "A128GCM", "A192GCM", "A256GCM"], "userinfo_endpoint": "https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key/userinfo", "version": "3.0", "registration_endpoint": "https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key/registration"}
1474010147.283092:protocol response:{'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'token_endpoint': 'https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key/token', 'version': '3.0', 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'end_session_endpoint': 'https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key/end_session', 'request_object_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'HS256', 'HS384', 'HS512', 'PS256', 'PS384', 'PS512', 'none'], 'token_endpoint_auth_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'HS256', 'HS384', 'HS512', 'PS256', 'PS384', 'PS512'], 'issuer': 'https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key', 'claims_supported': ['zoneinfo', 'preferred_username', 'picture', 'updated_at', 'middle_name', 'phone_number', 'address', 'name', 'nickname', 'email_verified', 'locale', 'gender', 'family_name', 'phone_number_verified', 'profile', 'website', 'sub', 'given_name', 'birthdate', 'email'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'registration_endpoint': 'https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key/registration', 'claims_parameter_supported': True, 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'id_token_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'HS256', 'HS384', 'HS512', 'PS256', 'PS384', 'PS512', 'none'], 'subject_types_supported': ['public', 'pairwise'], 'require_request_uri_registration': True, 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_uri_parameter_supported': True, 'scopes_supported': ['email', 'profile', 'openid', 'offline_access', 'address', 'phone', 'openid'], 'authorization_endpoint': 'https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key/authorization', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'acr_values_supported': ['PASSWORD'], 'jwks_uri': 'https://localhost:8080/static/jwks_EPQyNOxJBVeRQVvA.json', 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token', 'none'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_parameter_supported': True, 'userinfo_endpoint': 'https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key/userinfo', 'userinfo_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'HS256', 'HS384', 'HS512', 'PS256', 'PS384', 'PS512', 'none']}
1474010147.283557:protocol response:{'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'request_object_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'grant_types_supported': ['authorization_code', 'implicit', 'urn:ietf:params:oauth:grant-type:jwt-bearer'], 'token_endpoint': 'https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key/token', 'version': '3.0', 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'end_session_endpoint': 'https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key/end_session', 'request_object_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'HS256', 'HS384', 'HS512', 'PS256', 'PS384', 'PS512', 'none'], 'token_endpoint_auth_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'HS256', 'HS384', 'HS512', 'PS256', 'PS384', 'PS512'], 'issuer': 'https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key', 'claims_supported': ['zoneinfo', 'preferred_username', 'picture', 'updated_at', 'middle_name', 'phone_number', 'address', 'name', 'nickname', 'email_verified', 'locale', 'gender', 'family_name', 'phone_number_verified', 'profile', 'website', 'sub', 'given_name', 'birthdate', 'email'], 'userinfo_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'registration_endpoint': 'https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key/registration', 'claims_parameter_supported': True, 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'id_token_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'HS256', 'HS384', 'HS512', 'PS256', 'PS384', 'PS512', 'none'], 'subject_types_supported': ['public', 'pairwise'], 'require_request_uri_registration': True, 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'id_token_encryption_alg_values_supported': ['RSA1_5', 'RSA-OAEP', 'A128KW', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_uri_parameter_supported': True, 'scopes_supported': ['email', 'profile', 'openid', 'offline_access', 'address', 'phone', 'openid'], 'authorization_endpoint': 'https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key/authorization', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'acr_values_supported': ['PASSWORD'], 'jwks_uri': 'https://localhost:8080/static/jwks_EPQyNOxJBVeRQVvA.json', 'response_types_supported': ['code', 'token', 'id_token', 'code token', 'code id_token', 'id_token token', 'code token id_token', 'none'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'request_parameter_supported': True, 'userinfo_endpoint': 'https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key/userinfo', 'userinfo_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'HS256', 'HS384', 'HS512', 'PS256', 'PS384', 'PS512', 'none']}
1474010147.297868:response:{"grant_types": ["authorization_code"], "client_secret_expires_at": 1474096547, "response_types": ["code"], "userinfo_encrypted_response_alg": "RSA1_5", "redirect_uris": ["https://localhost:8088/authz_cb"], "userinfo_encrypted_response_enc": "A128CBC-HS256", "registration_access_token": "FFPEc9mWVxtjU0XyGDqwhF7ivDAnQa9o", "application_type": "web", "registration_client_uri": "https://localhost:8080/foobar1_C/registration?client_id=TiREq4y87xFg", "client_id_issued_at": 1474010147, "jwks_uri": "https://localhost:8088/static/jwk.json", "client_id": "TiREq4y87xFg", "client_secret": "a6115f7ba2e8e95e1069eb21fa4149d18b5da1cb739385a92a4fa69e"}
1474010147.297873:protocol response:{'client_id_issued_at': 1474010147, 'token_endpoint_auth_method': 'client_secret_basic', 'client_secret': 'a6115f7ba2e8e95e1069eb21fa4149d18b5da1cb739385a92a4fa69e', 'client_secret_expires_at': 1474096547, 'client_id': 'TiREq4y87xFg', 'userinfo_encrypted_response_alg': 'RSA1_5', 'userinfo_encrypted_response_enc': 'A128CBC-HS256', 'response_types': ['code'], 'registration_client_uri': 'https://localhost:8080/foobar1_C/registration?client_id=TiREq4y87xFg', 'redirect_uris': ['https://localhost:8088/authz_cb'], 'grant_types': ['authorization_code'], 'jwks_uri': 'https://localhost:8088/static/jwk.json', 'registration_access_token': 'FFPEc9mWVxtjU0XyGDqwhF7ivDAnQa9o', 'application_type': 'web'}
1474010147.298013:protocol response:{'client_id_issued_at': 1474010147, 'token_endpoint_auth_method': 'client_secret_basic', 'client_secret': 'a6115f7ba2e8e95e1069eb21fa4149d18b5da1cb739385a92a4fa69e', 'client_secret_expires_at': 1474096547, 'client_id': 'TiREq4y87xFg', 'userinfo_encrypted_response_alg': 'RSA1_5', 'userinfo_encrypted_response_enc': 'A128CBC-HS256', 'response_types': ['code'], 'registration_client_uri': 'https://localhost:8080/foobar1_C/registration?client_id=TiREq4y87xFg', 'redirect_uris': ['https://localhost:8088/authz_cb'], 'grant_types': ['authorization_code'], 'jwks_uri': 'https://localhost:8088/static/jwk.json', 'registration_access_token': 'FFPEc9mWVxtjU0XyGDqwhF7ivDAnQa9o', 'application_type': 'web'}
1474010147.298486:request:{'client_id': 'TiREq4y87xFg', 'nonce': 'oc9PftwI14maMRpA', 'response_type': 'code', 'scope': 'openid', 'state': '2pAJGqcvlVaeBO1X', 'redirect_uri': 'https://localhost:8088/authz_cb'}
1474010147.305396:http response:<otest.events.HTTPResponse object at 0x10718dba8>
1474010147.305729:response:state=2pAJGqcvlVaeBO1X&iss=https%3A%2F%2Flocalhost%3A8080%2Ffoobar1_C%2Frp-key-rotation-rp-enc-key&code=sOwI63uqld3G%2FRnPnaD0n2iUA9UIDCRA%2FQeb0QqN5dKt7qxFRLfWbvHjhYtNpqqkZJwKIcI6BYho3kCTbAAzo%2FeXMIkHo3Ri5BW2FeEZdPKcvZxr9jZSRo%2BdBIYZo5axCy006ijg9biiZ0dRPBMtUQ%3D%3D&scope=openid&client_id=TiREq4y87xFg
1474010147.305732:protocol response:{'client_id': 'TiREq4y87xFg', 'iss': 'https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key', 'code': 'sOwI63uqld3G/RnPnaD0n2iUA9UIDCRA/Qeb0QqN5dKt7qxFRLfWbvHjhYtNpqqkZJwKIcI6BYho3kCTbAAzo/eXMIkHo3Ri5BW2FeEZdPKcvZxr9jZSRo+dBIYZo5axCy006ijg9biiZ0dRPBMtUQ==', 'scope': 'openid', 'state': '2pAJGqcvlVaeBO1X'}
1474010147.305817:protocol response:{'client_id': 'TiREq4y87xFg', 'iss': 'https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key', 'code': 'sOwI63uqld3G/RnPnaD0n2iUA9UIDCRA/Qeb0QqN5dKt7qxFRLfWbvHjhYtNpqqkZJwKIcI6BYho3kCTbAAzo/eXMIkHo3Ri5BW2FeEZdPKcvZxr9jZSRo+dBIYZo5axCy006ijg9biiZ0dRPBMtUQ==', 'scope': 'openid', 'state': '2pAJGqcvlVaeBO1X'}
1474010147.305848:response:{'client_id': 'TiREq4y87xFg', 'iss': 'https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key', 'code': 'sOwI63uqld3G/RnPnaD0n2iUA9UIDCRA/Qeb0QqN5dKt7qxFRLfWbvHjhYtNpqqkZJwKIcI6BYho3kCTbAAzo/eXMIkHo3Ri5BW2FeEZdPKcvZxr9jZSRo+dBIYZo5axCy006ijg9biiZ0dRPBMtUQ==', 'scope': 'openid', 'state': '2pAJGqcvlVaeBO1X'}
1474010147.326071:response:{"access_token": "ga68N0sIwQpA/HSMEb+vBEhwisoL+y5H3YCF1AQcQLfmHEO1zUZAve8Wh1xS3P/0TSCvsi49GDh3+fbS9DBVlg6sRLYv2dWiXmwVxivYrh/fgJ4zrClH42OO6KaVWwBUeTmZRVDima6ngrpeitsz3A==", "state": "2pAJGqcvlVaeBO1X", "token_type": "Bearer", "id_token": "eyJraWQiOiJhMSIsImFsZyI6IlJTMjU2In0.eyJhdXRoX3RpbWUiOiAxNDc0MDEwMTQ3LCAiaWF0IjogMTQ3NDAxMDE0NywgImV4cCI6IDE0NzQwOTY1NDcsICJzdWIiOiAiMWIyZmM5MzQxYTE2YWU0ZTMwMDgyOTY1ZDUzN2FlNDdjMjFhMGYyN2ZkNDNlYWI3ODMzMGVkODE3NTFhZTZkYiIsICJub25jZSI6ICJvYzlQZnR3STE0bWFNUnBBIiwgImFjciI6ICJQQVNTV09SRCIsICJhdWQiOiBbIlRpUkVxNHk4N3hGZyJdLCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwODAvZm9vYmFyMV9DL3JwLWtleS1yb3RhdGlvbi1ycC1lbmMta2V5In0.mRYb93J_VCbGpdjLXpI-Xf6K4XJRi514ua58qLD2dKeUtyi11NRXMHpZG8YVHXKu9r33JtCLK7IRNoKo5smQds2K9ZTgWsCyT27p458qoKUzA2aB0HBBQiQvIhc2dFKJq6hmWXnH1IKfSE-3PNpj9V-gv4wgS02sttqqYcIuTgE", "scope": "openid"}
1474010147.326075:protocol response:{'state': '2pAJGqcvlVaeBO1X', 'id_token': {'exp': 1474096547, 'aud': ['TiREq4y87xFg'], 'auth_time': 1474010147, 'iss': 'https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key', 'nonce': 'oc9PftwI14maMRpA', 'acr': 'PASSWORD', 'iat': 1474010147, 'sub': '1b2fc9341a16ae4e30082965d537ae47c21a0f27fd43eab78330ed81751ae6db'}, 'token_type': 'Bearer', 'access_token': 'ga68N0sIwQpA/HSMEb+vBEhwisoL+y5H3YCF1AQcQLfmHEO1zUZAve8Wh1xS3P/0TSCvsi49GDh3+fbS9DBVlg6sRLYv2dWiXmwVxivYrh/fgJ4zrClH42OO6KaVWwBUeTmZRVDima6ngrpeitsz3A==', 'scope': 'openid'}
1474010147.352684:response:eyJraWQiOiJtZFF2SVdMOVpZOEoxdjJwRkN2bjZGZkRHN2JIR3h0ZkZ4cHpLeEN2YlV3IiwiYWxnIjoiUlNBMV81IiwiZW5jIjoiQTEyOENCQy1IUzI1NiJ9.q4dS2MtTwgzUONUNaxRZX9SEKpp4EyoD8_a4b9ZjvPWMAg81FIgiWCZ4eKAv4K3Z8qm4JbwXMgShnCdx4Q_kMjKRD7hBmDP6ekhHLAeTcqk9aglU5FYvQZaBEQwOsryVwfcByXED1kcZ6bE37fXSN0F-_ZasQZMhv8FlvcP0q_eyWo-1R89Lg7QoTd_GYRAKyLOYE2-mYe-c7zjqfAHx7dtDiiwLq8X3gXMBdlEiTQjG6zMs4pueHJBSjo4rZ0kQnlx8X9iaI1vn9tlCXPvl5tSOG_2jlX1QGK0AehvR-HfdoaZ9JyZ8ZorZnyN6UfTFry5qyn9S677BO1d603Pn7g.6kG9SgoiO_0xcCXAxo2x6g.-6prDUXzhYq0_t57soRCMhIaVkHliml8eRv56QazgVOO5YHntm68ESsWVM8mkzKUsl8nse1fbfSdni71Cvn0Kyt-8qva-A6wQ6ph1fTMlf8.5naSQ6CmbzXclbsC9pBdeA
1474010147.352689:protocol response:{'sub': '1b2fc9341a16ae4e30082965d537ae47c21a0f27fd43eab78330ed81751ae6db'}
1474010148.784715:request:{'client_id': 'TiREq4y87xFg', 'nonce': 'ifEZ6tv2jHCXvv91', 'response_type': 'code', 'scope': 'openid', 'state': 'vteEfhgLQEuHNjdh', 'redirect_uri': 'https://localhost:8088/authz_cb'}
1474010148.792013:http response:<otest.events.HTTPResponse object at 0x107195e48>
1474010148.792291:response:state=vteEfhgLQEuHNjdh&iss=https%3A%2F%2Flocalhost%3A8080%2Ffoobar1_C%2Frp-key-rotation-rp-enc-key&code=7njxEOMwLrgMKirwm7CoBW6DrniUnOmX97u%2B0%2Bx%2B%2FusRsuR8182m8F%2BZcggBKqcVnxZlK1DHmiyRcMmPrkzj3NJQxJ993y1L7fR6FkdIx%2FvBKQwLS0IYF8eu0ShXXZMd32TY%2BVT0MyVqXg8Kc6yD%2Bw%3D%3D&scope=openid&client_id=TiREq4y87xFg
1474010148.792293:protocol response:{'client_id': 'TiREq4y87xFg', 'iss': 'https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key', 'code': '7njxEOMwLrgMKirwm7CoBW6DrniUnOmX97u+0+x+/usRsuR8182m8F+ZcggBKqcVnxZlK1DHmiyRcMmPrkzj3NJQxJ993y1L7fR6FkdIx/vBKQwLS0IYF8eu0ShXXZMd32TY+VT0MyVqXg8Kc6yD+w==', 'scope': 'openid', 'state': 'vteEfhgLQEuHNjdh'}
1474010148.792374:protocol response:{'client_id': 'TiREq4y87xFg', 'iss': 'https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key', 'code': '7njxEOMwLrgMKirwm7CoBW6DrniUnOmX97u+0+x+/usRsuR8182m8F+ZcggBKqcVnxZlK1DHmiyRcMmPrkzj3NJQxJ993y1L7fR6FkdIx/vBKQwLS0IYF8eu0ShXXZMd32TY+VT0MyVqXg8Kc6yD+w==', 'scope': 'openid', 'state': 'vteEfhgLQEuHNjdh'}
1474010148.792404:response:{'client_id': 'TiREq4y87xFg', 'iss': 'https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key', 'code': '7njxEOMwLrgMKirwm7CoBW6DrniUnOmX97u+0+x+/usRsuR8182m8F+ZcggBKqcVnxZlK1DHmiyRcMmPrkzj3NJQxJ993y1L7fR6FkdIx/vBKQwLS0IYF8eu0ShXXZMd32TY+VT0MyVqXg8Kc6yD+w==', 'scope': 'openid', 'state': 'vteEfhgLQEuHNjdh'}
1474010148.955743:response:{"access_token": "Dh8kNC3RQD+0owwzUaXPOwmBGzCGX5oopumtBsANdqdmywj23rc2diUgCENekBod2SsZLTTW6zIt76xj8BG+MT40/Wg3Ln8W2D7yvcXribEzWOAV6VoYzxV+QhPaaC2bjQn7fr601nthHt3Te7iESQ==", "state": "vteEfhgLQEuHNjdh", "token_type": "Bearer", "id_token": "eyJraWQiOiJhMSIsImFsZyI6IlJTMjU2In0.eyJhdXRoX3RpbWUiOiAxNDc0MDEwMTQ4LCAiaWF0IjogMTQ3NDAxMDE0OCwgImV4cCI6IDE0NzQwOTY1NDgsICJzdWIiOiAiMWIyZmM5MzQxYTE2YWU0ZTMwMDgyOTY1ZDUzN2FlNDdjMjFhMGYyN2ZkNDNlYWI3ODMzMGVkODE3NTFhZTZkYiIsICJub25jZSI6ICJpZkVaNnR2MmpIQ1h2djkxIiwgImFjciI6ICJQQVNTV09SRCIsICJhdWQiOiBbIlRpUkVxNHk4N3hGZyJdLCAiaXNzIjogImh0dHBzOi8vbG9jYWxob3N0OjgwODAvZm9vYmFyMV9DL3JwLWtleS1yb3RhdGlvbi1ycC1lbmMta2V5In0.Kfa3URsj6veOq5akc0jR5Gw4fF4uD2O6gVF5Y6rx4KypIOzjw07HjTVDta0qlgQgMXq26S8ifIY4-G8CUYR5UCLkiYgJ9AIsdHeqmoSF1oJdvkUIEkO4uS2RN7TJDuw5ESbcrklXCrHKntBB5DmP2Pshv1B9jJN0YO_n_oNu5Ro", "scope": "openid"}
1474010148.955746:protocol response:{'state': 'vteEfhgLQEuHNjdh', 'id_token': {'exp': 1474096548, 'aud': ['TiREq4y87xFg'], 'auth_time': 1474010148, 'iss': 'https://localhost:8080/foobar1_C/rp-key-rotation-rp-enc-key', 'nonce': 'ifEZ6tv2jHCXvv91', 'acr': 'PASSWORD', 'iat': 1474010148, 'sub': '1b2fc9341a16ae4e30082965d537ae47c21a0f27fd43eab78330ed81751ae6db'}, 'token_type': 'Bearer', 'access_token': 'Dh8kNC3RQD+0owwzUaXPOwmBGzCGX5oopumtBsANdqdmywj23rc2diUgCENekBod2SsZLTTW6zIt76xj8BG+MT40/Wg3Ln8W2D7yvcXribEzWOAV6VoYzxV+QhPaaC2bjQn7fr601nthHt3Te7iESQ==', 'scope': 'openid'}
1474010148.977135:response:eyJraWQiOiJyb3RhdGVkX2VuY19rZXkiLCJhbGciOiJSU0ExXzUiLCJlbmMiOiJBMTI4Q0JDLUhTMjU2In0.ozrnVkMAHeg9q_cUL8aZyp7vJCayEjM4sIVExFdnu-PuakWkUOS4G40NGvQgnbUJQ8qd0NNj7oB6TvHVxGIRu0Y3jWMsIeoIKECOFwvtCtz1bvZMdXsz4teYqS1WFp018VrydQdU3abWZ3dmxdK2ku4RiGDs-067bXYTbOl8jqPNlUXqR9QtzG_rVwRHSLAu3g3-Y3MLQOiq_3sF8wmXfCYqKZZ9H1T_r6YIhkmXbS-7u8vAGzJtdhEFjkvGiA4NnLS7hHG1UbqoxQTHYiOHuSnDayWi7he7cv6oM10jbi_T876G4K7hKO4tg6EgOeOcl2D8zuuaBVJAT_bH7beE0A.r54jqIhtUsbJqWARcEVweg.EnSnNdTZJI3e5By2gCZlC8Y48IWfHURS8kijwHwVOsRs92sjkn8mAcuMPwNPuW8Bj5iLX1CRKzopTtH2WtfRDWEWfAYwB76s_5cSpxTzKgE.CThO_Kp3C0XHqV8rlIGbrQ
1474010148.977139:protocol response:{'sub': '1b2fc9341a16ae4e30082965d537ae47c21a0f27fd43eab78330ed81751ae6db'}
1474010148.979073:condition:Done: status=OK

============================================================

RESULT: PASSED
