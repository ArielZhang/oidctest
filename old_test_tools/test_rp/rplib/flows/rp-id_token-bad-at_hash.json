{
  "desc": "The Relying Party should request an ID token and reject it if the at_hash claim is incorrect",
  "sequence": [
    {
      "Webfinger": {
        "set_webfinger_resource": null
      }
    },
    {
      "Discovery": {
        "set_discovery_issuer": null
      }
    },
    "Registration",
    {
      "SyncAuthn": {
        "conditional_expect_exception": {
          "condition": {
            "response_type": [
              [
                "code",
                "id_token",
                "token"
              ],
              [
                "id_token",
                "token"
              ]
            ]
          },
          "exception": "AtHashError"
        }
      }
    }
  ],
  "usage": {
    "return_type": [
      "CIT",
      "IT"
    ]
  }
}
